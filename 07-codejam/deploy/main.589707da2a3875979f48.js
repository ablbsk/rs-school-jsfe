!function(){"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),function(){var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var o=n.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t}();var t=e.p+"assets/move.mp3";function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}window.onload=function(e){e.preventDefault();!function(){var e=document.createElement("main");e.classList.add("main"),document.body.append(e);var t,n;(t=document.createElement("header")).classList.add("header"),t.innerHTML='<h1 class="header__title">Gem Puzzle</h1>\n        <div class="header__controls">\n          <button id="buttonStart" class="header__button">Start</button>\n          <button id="buttonPause" class="header__button header__button--pause" disabled>Pause</button>\n          <button id="buttonSave" class="header__button" disabled>Save</button>\n          <button id="buttonResult" class="header__button">Results</button>\n        </div>',e.append(t),function(){var t=document.createElement("div");t.classList.add("top-result","hidden"),t.innerHTML='<ul class="top-result__line top-result__line--header">\n        <li class="top-result__item">#</li>\n        <li class="top-result__item">Size</li>\n        <li class="top-result__item">Time</li>\n        <li class="top-result__item">Moves</li>\n      </ul>',t.addEventListener("click",(function(){return t.classList.add("hidden")})),e.append(t);var n=document.createElement("div");n.classList.add("message","message--victory","hidden"),e.append(n);var o=document.createElement("div");o.classList.add("playground"),e.append(o)}(),(n=document.createElement("footer")).classList.add("footer"),n.innerHTML='<div class="footer__info">\n          <span class="stopwatch">00:00:00</span>\n          <span class="sound sound--on"></span>\n          <span class="footer__move">Moves: 0</span>\n        </div>\n        <div class="sizes">\n          <p class="sizes__title">Other sizes:</p>\n          <ul class="sizes__list">\n            <li class="sizes__list-item">3x3</li>\n            <li class="sizes__list-item sizes__list-item--active">4x4</li>\n            <li class="sizes__list-item">5x5</li>\n            <li class="sizes__list-item">6x6</li>\n            <li class="sizes__list-item">7x7</li>\n            <li class="sizes__list-item">8x8</li>\n          </ul>\n        </div>',e.append(n)}();var o=document.getElementById("buttonStart"),s=document.getElementById("buttonPause"),i=document.getElementById("buttonSave"),a=document.getElementById("buttonResult"),r=document.querySelector(".playground"),l=document.querySelector(".footer__move"),c=document.querySelector(".stopwatch"),u=document.querySelector(".sound"),m=document.querySelector(".top-result"),d=document.querySelector(".message"),p=0,f={},v=4,g=[],h=[],_=!0,S=!1,L=0,y=null,b=0,T=!1,I=[];function E(e){var n;if(_&&Math.abs(f.positionTop-h[e].positionTop)+Math.abs(f.positionLeft-h[e].positionLeft)<=1){_=!1;var o=f.positionTop,a=f.positionLeft;f.positionTop=h[e].positionTop,f.positionLeft=h[e].positionLeft,h[e].positionTop=o,h[e].positionLeft=a,h[e].element.style.top="".concat(o*p*.1,"rem"),h[e].element.style.left="".concat(a*p*.1,"rem"),L++,l.textContent="Moves: ".concat(L),n=new Audio(t),T||n.play(),function(){var e=!0,t=h.slice();t.sort((function(e,t){return e.positionTop+e.positionLeft-t.positionTop-t.positionLeft})).sort((function(e,t){return e.positionTop-t.positionTop}));for(var n=0;n<t.length-2;n++)t[n+1].number-t[n].number!=1&&(e=!1);return e}()&&function(){clearTimeout(y),s.disabled=!0,i.disabled=!0,d.innerHTML='\n      <span class="line line--gold">Hooray!</span>\n      <span class="line">You solved the puzzle in '.concat(c.textContent," and ").concat(L," moves!</span>\n    "),setTimeout((function(){d.classList.remove("hidden"),_=!1}),501);var e={size:v,time:c.textContent,moves:L},t=1;I.push(e),I.sort((function(e,t){return e.moves-t.moves})),I.length>10&&(I=I.slice(0,10));m.innerHTML='<ul class="top-result__line top-result__line--header">\n        <li class="top-result__item">#</li>\n        <li class="top-result__item-item">Size</li>\n        <li class="top-result__item">Time</li>\n        <li class="top-result__item">Moves</li>\n      </ul>',I.forEach((function(e){var n=document.createElement("ul");n.classList.add("top-result__line");var o=document.createElement("li");o.textContent=t,o.className="top-result__item",n.append(o);var s=document.createElement("li");s.textContent=e.size,s.className="top-result__item",n.append(s);var i=document.createElement("li");i.textContent=e.time,i.className="top-result__item",n.append(i);var a=document.createElement("li");a.textContent=e.moves,a.className="top-result__item",n.append(a),m.append(n),t++})),localStorage.setItem("leaderBoard",JSON.stringify(I)),localStorage.setItem("results",m.innerHTML)}()}}function x(e,t,n){var o=e||0,s=t||0,i=n||0;60===++o&&(s++,o=0),60===s&&(i++,s=0),y=setTimeout((function(){return x(o,s,i)}),1e3),c.textContent="".concat(i.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"),":").concat(o.toString().padStart(2,"0"))}function w(){x.apply(void 0,n(b)),s.textContent="Pause",S=!1,document.querySelector(".message--pause").remove()}function z(){s.disabled=!1,i.disabled=!1,_=!0,r.innerHTML="",f.positionLeft=v-1,f.positionTop=v-1,f.number=0,p=r.clientWidth/v,h=[],g=[],L=0,l.textContent="Moves: ".concat(L),c.textContent="00:00:00",clearTimeout(y),y=null,x(0,0,0);for(var e=1;e<v*v;e++)g.push(e);g.sort((function(){return Math.random()-.5}));for(var t=function(e){var t=document.createElement("div"),n=e%v,o=(e-e%v)/v;h.push({positionLeft:n,positionTop:o,number:g[e],element:t}),t.className="gem",t.style.width="".concat(.1*p,"rem"),t.style.height="".concat(.1*p,"rem"),t.style.left="".concat(n*p*.1,"rem"),t.style.top="".concat(o*p*.1,"rem"),t.textContent=g[e],t.addEventListener("click",(function(){return E(e)})),t.addEventListener("transitionend",(function(){_=!0})),r.append(t)},n=0;n<v*v-1;n++)t(n);h.push(f),M()}function M(){var e=+v,t=h.slice();t.sort((function(e,t){return e.positionTop+e.positionLeft-t.positionTop-t.positionLeft})).sort((function(e,t){return e.positionTop-t.positionTop}));for(var n=0;n<t.length-1;n++)for(var o=n+1;o<t.length-1;o++)t[n].number>t[o].number&&e++;(v%2==0&&e%2!=0||v%2!=0&&e%2==0)&&(z(),M())}if(localStorage.getItem("numbers")){s.disabled=!1,i.disabled=!1,i.textContent="Reset save",r.innerHTML="",v=+localStorage.getItem("size");var C=document.querySelectorAll(".sizes__list-item");document.querySelector(".sizes__list-item--active").classList.remove("sizes__list-item--active"),C[+v-3].classList.add("sizes__list-item--active"),g=JSON.parse(localStorage.getItem("numbers"));var N=JSON.parse(localStorage.getItem("lefts")),q=JSON.parse(localStorage.getItem("tops"));p=r.clientWidth/v,L=localStorage.getItem("currentMoves"),l.textContent="Moves: ".concat(L),c.textContent=localStorage.getItem("currentTime"),clearTimeout(y),y=null,x(+localStorage.getItem("currentTime").slice(6),+localStorage.getItem("currentTime").slice(3,5),+localStorage.getItem("currentTime").slice(0,2));for(var A=function(e){var t=document.createElement("div"),n=N[e],o=q[e];h.push({positionLeft:n,positionTop:o,number:g[e],element:t}),t.className="gem",t.style.width="".concat(.1*p,"rem"),t.style.height="".concat(.1*p,"rem"),t.style.left="".concat(n*p*.1,"rem"),t.style.top="".concat(o*p*.1,"rem"),t.textContent=g[e],t.addEventListener("click",(function(){return E(e)})),t.addEventListener("transitionend",(function(){_=!0})),r.append(t)},k=0;k<v*v-1;k++)A(k);f.positionLeft=+localStorage.getItem("nullLeft"),f.positionTop=+localStorage.getItem("nullTop"),f.number=0,h.push(f)}localStorage.getItem("results")&&(m.innerHTML=localStorage.getItem("results")),localStorage.getItem("leaderBoard")&&(I=JSON.parse(localStorage.getItem("leaderBoard"))),document.querySelectorAll(".sizes__list-item").forEach((function(e){e.addEventListener("click",(function(){2!==e.classList.length&&(document.querySelector(".sizes__list-item--active").classList.remove("sizes__list-item--active"),v=e.textContent.charAt(0),e.classList.add("sizes__list-item--active"),z())}))})),o.addEventListener("click",(function(){z(),1===m.classList.length&&m.classList.add("hidden"),2===d.classList.length&&d.classList.add("hidden")})),s.addEventListener("click",(function(){return S?w():function(){clearTimeout(y);var e=+c.textContent.slice(0,2),t=+c.textContent.slice(3,5),n=+c.textContent.slice(6);b=[n,t,e],S=!0,s.textContent="Resume";var o=document.createElement("div");return o.className="message message--pause",o.innerHTML='<span class="line">Game paused</span>',document.querySelector(".main").append(o),o.addEventListener("click",(function(){S=!1,w(),o.remove()})),b}()})),u.addEventListener("click",(function(){u.classList.toggle("sound--on"),u.classList.toggle("sound--off"),T=!T})),i.addEventListener("click",(function(){if(localStorage.getItem("numbers"))localStorage.removeItem("numbers"),localStorage.removeItem("lefts"),localStorage.removeItem("tops"),localStorage.removeItem("nullLeft"),localStorage.removeItem("nullTop"),localStorage.removeItem("size"),localStorage.removeItem("currentMoves"),localStorage.removeItem("currentTime"),i.textContent="Save game";else{var e=[],t=[],n=[],o=0,s=0;h.forEach((function(i){0===i.number&&(o=i.positionLeft,s=i.positionTop),e.push(i.positionLeft),t.push(i.positionTop),n.push(i.number)})),localStorage.setItem("numbers",JSON.stringify(n)),localStorage.setItem("lefts",JSON.stringify(e)),localStorage.setItem("tops",JSON.stringify(t)),localStorage.setItem("nullLeft",o),localStorage.setItem("nullTop",s),localStorage.setItem("size",v),localStorage.setItem("currentMoves",L),localStorage.setItem("currentTime",c.textContent),i.textContent="Reset save"}})),window.addEventListener("click",(function(){d.classList.contains("hidden")||e.target.classList.contains("victory")||d.classList.add("hidden")})),a.addEventListener("click",(function(){2===m.classList.length?m.classList.remove("hidden"):m.classList.add("hidden")})),window.addEventListener("resize",(function(){var e=document.querySelector(".playground").clientWidth,t=document.querySelectorAll(".gem"),n=function(){if(0!==t.length){var n=Number.parseInt(t[0].style.width,10);p=e/v,t.forEach((function(e){var t=Math.floor(Number.parseInt(e.style.top,10)/n),o=Math.floor(Number.parseInt(e.style.left,10)/n);e.style.width="".concat(.1*p,"rem"),e.style.height="".concat(.1*p,"rem"),e.style.top=t?"".concat(p*t*.1,"rem"):"0rem",e.style.left=o?"".concat(p*o*.1,"rem"):"0rem"}))}};window.matchMedia("(max-width: 1440px)").matches&&n(),window.matchMedia("(max-width: 1280px)").matches&&n(),window.matchMedia("(max-width: 768px)").matches&&n(),window.matchMedia("(max-width: 552px)").matches&&n()}))}}();